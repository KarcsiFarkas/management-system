{% extends "layout.html" %}
{% block content %}
<div class="dashboard-header">
    <h2>Welcome, {{ current_user.username }}!</h2>
    <a href="{{ url_for('views.new_config') }}" class="button primary">Create New Configuration</a>
</div>

<div class="card">
    <h3>Global & Universal Settings</h3>
    <form method="POST" action="{{ url_for('views.update_settings') }}">
        <div class="form-row">
            <div>
                <label for="global_domain">Default Domain</label>
                <input type="text" id="global_domain" name="global_domain" value="{{ current_user.global_domain or 'example.local' }}">
            </div>
            <div>
                <label for="global_timezone">Timezone</label>
                <input type="text" id="global_timezone" name="global_timezone" value="{{ current_user.global_timezone or 'Etc/UTC' }}">
            </div>
        </div>
        <div class="form-row">
            <div>
                <label for="universal_username">Universal Service Username</label>
                <input type="text" id="universal_username" name="universal_username" value="{{ current_user.universal_username or current_user.username }}">
                <p class="help-text">This username will be used when creating accounts in your services.</p>
            </div>
            <div>
                <label for="password_mode_select">Generate Unique Passwords For Me (Recommended)</label>
                <select name="password_mode" id="password_mode_select">
                    <option value="generate" {% if current_user.password_mode == 'generate' %}selected{% endif %}>Yes</option>
                    <option value="custom" {% if current_user.password_mode == 'custom' %}selected{% endif %}>No</option>
                </select>
            </div>
        </div>

        <div id="custom_password_field" style="display: none;">
            <label for="universal_password_custom">Custom Universal Password</label>
            <input type="password" id="universal_password_custom" name="universal_password_custom" value="{{ current_user.universal_password_custom or '' }}">
            <p class="help-text">Warning: Using the same password for multiple services is a security risk.</p>
        </div>

        <button type="submit" class="button primary">Save Settings</button>
    </form>
</div>

<div class="card">
    <h3>Your Configurations</h3>
    {% if configs %}
    <ul class="config-list">
        {% for config in configs %}
        <li>
            <span>{{ config }}</span>
            <div class="config-actions">
                <a href="{{ url_for('views.user_edit_config', config_name=config) }}" class="button">Edit</a>
            </div>
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p>You have not created any configurations yet.</p>
    {% endif %}
</div>
{% endblock %}