{% extends "layout.html" %}
{% block content %}
<div class="dashboard-header">
    <h2>Welcome, {{ current_user.username }}!</h2>
    <a href="{{ url_for('views.profile') }}" class="button primary">
        {% if profile %}Edit Your Profile{% else %}Create Your Profile{% endif %}
    </a>
</div>

{% if profile %}
    {# --- Display this section if the user ALREADY HAS a profile --- #}
    <div class="card summary-card is-collapsed">
        <div class="service-card-header">
            <div class="service-card-title">
                <h4>General Configuration</h4>
                <p class="help-text">Your main deployment settings.</p>
            </div>
            <div class="service-card-controls">
                <button type="button" class="toggle-button">
                    <span class="toggle-text">Expand</span>
                    <span class="toggle-arrow">▼</span>
                </button>
            </div>
        </div>
        <div class="service-card-body">
            <ul class="config-summary-list">
                <li>
                    <strong>Tenant Domain:</strong>
                    <code>{{ profile.general.tenant_domain }}</code>
                </li>
                <li>
                    <strong>Deployment Runtime:</strong>
                    <code>{{ profile.general.deployment_runtime }}</code>
                </li>
                 <li>
                    <strong>Timezone:</strong>
                    <code>{{ profile.general.timezone }}</code>
                </li>
                <li>
                    <strong>Universal Username:</strong>
                    <code>{{ profile.general.universal_username }}</code>
                </li>
            </ul>
        </div>
    </div>

    <div class="card summary-card">
        <div class="service-card-header">
            <div class="service-card-title">
                <h4>Service Selections</h4>
                <p class="help-text">A summary of your enabled services.</p>
            </div>
            <div class="service-card-controls">
                <button type="button" class="toggle-button">
                    <span class="toggle-text">Collapse</span>
                    <span class="toggle-arrow">▼</span>
                </button>
            </div>
        </div>
        <div class="service-card-body">
             <div class="service-tag-container">
                {% for service in profile.services.keys() %}
                    <span class="service-tag">{{ service }}</span>
                {% else %}
                    <p>No services are currently enabled in your profile.</p>
                {% endfor %}
            </div>
        </div>
    </div>
{% else %}
    {# --- Display this section if the user IS NEW --- #}
    <div class="card summary-card">
        <div class="service-card-header" style="cursor: default;">
             <div class="service-card-title">
                <h4>Get Started</h4>
            </div>
        </div>
        <div class="service-card-body">
            <p>You have not created a profile yet. A profile contains all the settings for the services you want to deploy.</p>
            <p>Click the <strong>"Create Your Profile"</strong> button at the top right to begin.</p>
        </div>
    </div>
{% endif %}
{% endblock %}