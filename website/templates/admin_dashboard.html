{% extends "layout.html" %}
{% block content %}
<div class="dashboard-header">
    <h2>Admin Dashboard</h2>
    <p>View and manage all user tenants.</p>
</div>

{% if users %}
<div class="card">
    <h3>Registered Users</h3>
    <p class="help-text">This is a list of all non-admin users in the database.</p>
    <div class="user-list">
        {% for user in users %}
            <span class="button-like">{{ user.username }}</span>
        {% endfor %}
    </div>
</div>
{% endif %}

{% if tenants %}
<div class="card">
    <h3>Manage Tenant Profiles</h3>
    <form id="load-tenant-form">
        <select name="tenant_name" id="tenant-select" required>
            <option value="" disabled selected>-- Select a tenant profile to edit --</option>
            {% for tenant in tenants %}
                <option value="{{ tenant }}">{{ tenant }}</option>
            {% endfor %}
        </select>
        <button type="submit" class="button primary">Edit Selected Tenant</button>
    </form>
</div>
{% else %}
<div class="card">
    <p>No existing tenant profiles found in the configuration repository.</p>
</div>
{% endif %}

<script>
    document.getElementById('load-tenant-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const select = document.getElementById('tenant-select');
        const tenantName = select.value;
        if (tenantName) {
            // Correctly build the URL for the admin edit route
            window.location.href = "{{ url_for('admin.index') }}edit/" + tenantName;
        }
    });
</script>
{% endblock %}